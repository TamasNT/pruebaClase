-- 1
DROP DATABASE IF EXISTS nagy;
CREATE DATABASE nagy;
use nagy;

-- 2
DELIMITER // 
CREATE PROCEDURE Suma(n INT(11), m INT(11)) 
BEGIN 
SELECT n+m; 
END //
DELIMITER ;

-- 3
CALL Suma(2,3);

-- 4
CREATE FUNCTION Operaciones(a INT(11), b INT(11), c INT(11))
	RETURNS INT(11)
RETURN a+b-c;

-- 5
select Operaciones(2,2,3);

-- 6
DELIMITER //
CREATE FUNCTION Suma10() RETURNS INT(11)
BEGIN 
	 DECLARE i INT DEFAULT 0;
	 DECLARE res INT DEFAULT 0;
	 while(i<=10) do
		 SET res=res+i;
		 SET i=i+1;
	 END while;
	 RETURN res;
END //
DELIMITER ;

-- 7
SELECT Suma10();

-- 8
DELIMITER //
CREATE PROCEDURE ElMayor(a INT(11), b INT(11), c INT(11), OUT biggest INT(11))
BEGIN
	 DECLARE mayor INT DEFAULT 0;
	 IF a > mayor then
	 	 SET mayor = a;
	 END IF;
	 IF b > mayor then
	 	 SET mayor = b;
	 END IF;
	 IF c > mayor then
	 	 SET mayor = c;
	 END IF;
	 SET biggest = mayor;
END //
DELIMITER ;

-- 9
CALL ElMayor(5,4,3, @mayor);
SELECT @mayor;
CALL ElMayor(5,4,13, @mayor);
SELECT @mayor;
CALL ElMayor(5,14,3, @mayor);
SELECT @mayor;
CALL ElMayor(1,4,5, @mayor);
SELECT @mayor;
CALL ElMayor(1,4,3, @mayor);
SELECT @mayor;

-- 10 
CREATE FUNCTION Cuadrado(n INT(11)) RETURNS INT(11)
RETURN n*n;

SELECT Cuadrado(3);

-- 11
CREATE FUNCTION Cubo(n INT(11)) RETURNS INT(11)
RETURN Cuadrado(n)*n;

SELECT Cubo(2);

-- 12
DROP DATABASE IF EXISTS empleados_depart;
CREATE DATABASE empleados_depart;
USE empleados_depart;

CREATE TABLE depart(
    dept_no int PRIMARY KEY,
	dnombre VARCHAR(30),
	loc VARCHAR(30)
);

CREATE TABLE emple(
	emp_no int (6)PRIMARY KEY,
	apellido VARCHAR(50) NOT NULL,
	oficio VARCHAR(30),
	dir int (6),
	fecha_alt DATE,
	salario int,
	comision int,	
	dept_no int
);	

INSERT INTO depart VALUES(10,'CONTABILIDAD','SEVILLA');
INSERT INTO depart VALUES(20,'INVESTIGACION','MADRID');
INSERT INTO depart VALUES(30,'VENTAS','BARCELONA');
INSERT INTO depart VALUES(40,'PRODUCCION','CORDOBA');

INSERT INTO emple VALUES(7369,'SANCHEZ','EMPLEADO',7902,'1990/12/17',1040,NULL,20);
INSERT INTO emple VALUES(7499,'ARROYO','VENDEDOR',7698,'1990/02/20',1500,390,30);
INSERT INTO emple VALUES(7521,'SALA','VENDEDOR',7698,'1991/02/22',1625,650,30);
INSERT INTO emple VALUES(7566,'JIMENEZ','DIRECTOR',7839,'1991/04/02',2900,NULL,20);
INSERT INTO emple VALUES(7654,'MARTIN','VENDEDOR',7698,'1991/09/29',1600,1020,30);
INSERT INTO emple VALUES (7698,'NEGRO','DIRECTOR',7839,'1991/05/01',3005,NULL,30);
INSERT INTO emple VALUES(7782,'CEREZO','DIRECTOR',7839,'1991/06/09',2885,NULL,10);
INSERT INTO emple VALUES(7788,'GIL','ANALISTA',7566,'1991/11/09',3000,NULL,20);
INSERT INTO emple VALUES(7839,'REY','PRESIDENTE',NULL,'1991/11/17',4100,NULL,10);
INSERT INTO emple VALUES(7844,'TOVAR','VENDEDOR',7698,'1991/08/09',1350,0,30);
INSERT INTO emple VALUES(7876,'ALONSO','EMPLEADO',7788,'1991/09/23',1430,NULL,20);
INSERT INTO emple VALUES(7900,'JIMENO','EMPLEADO',7698,'1991/12/03',1335,NULL,30);
INSERT INTO emple VALUES(7902,'FERNANDEZ','ANALISTA',7566,'1991/12/03',3000,NULL,20);
INSERT INTO emple VALUES(7934,'MUÃ‘OZ','EMPLEADO',7782,'1992/01/23',1690,NULL,10);

-- 13
DELIMITER //
CREATE PROCEDURE BorrarEmpleado(codigoEmpleado INT(11))
BEGIN
DELETE FROM emple WHERE emp_no = codigoEmpleado;
END //
DELIMITER ;

--  14
SELECT * FROM emple;
CALL BorrarEmpleado(7900);
SELECT * FROM emple;

--  15
DELIMITER //
CREATE PROCEDURE CambiaLocalidad(codigoDepartamento INT(11), nuevaLocalizacion varchar(30))
BEGIN
UPDATE depart SET loc = nuevaLocalizacion WHERE dept_no = codigoDepartamento;
END //
DELIMITER ;

-- 16
SELECT * FROM depart;
CALL CambiaLocalidad(20, "MADRID");
SELECT * FROM depart;